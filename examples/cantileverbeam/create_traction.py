import numpy as np

thickness = 1

# nodes = np.array([
# 	[33, 16, -2],
# 	[66, 16, -1.5],
# 	[99, 16, -1],
# 	[132, 16, -0.5],
# 	[165, 16, 0.0],
# 	[198, 16, 0.5],
# 	[231, 16, 1],
# 	[264, 16, 1.5],
# 	[297, 16, 2]
# ])
#
# traction = np.array([
# 	[33, 0, 0],
# 	[66, 0, -164.0625],
# 	[99, 0, -281.2500],
# 	[132, 0, -351.5625],
# 	[165, 0, -375.0000],
# 	[198, 0, -351.5625],
# 	[231, 0, -281.2500],
# 	[264, 0, -164.0625],
# 	[297, 0, 0]]) # A sequence of node must be in this list

nodes = np.array([
[1,		0.0,		0.0],
[3,		0.00999999978,		0.0],
[5,		0.0199999996,		0.0],
[7,		0.0299999993,		0.0],
[9,		0.0399999991,		0.0],
[11,		0.0500000007,		0.0],
[13,		0.0599999987,		0.0],
[15,		0.0700000003,		0.0],
[17,		0.0799999982,		0.0],
[19,		0.0900000036,		0.0],
[21,		0.100000001,		0.0],
[23,		0.109999999,	0.0],
[25,		0.119999997,		0.0],
[27,		0.129999995,	0.0],
[29,		0.140000001,		0.0],
[31,		0.150000006,		0.0],
[33,		0.159999996,		0.0],
[35,		0.170000002,		0.0],
[37,		0.180000007,		0.0],
[39,		0.189999998,		0.0],
[41,		0.200000003,		0.0],
[43,		0.209999993,		0.0],
[45,		0.219999999,		0.0],
[47,		0.230000004,		0.0],
[49,		0.239999995,		0.0],
[51,		0.25,		0.0],
[53,		0.25999999,		0.0],
[55,		0.270000011,		0.0],
[57,		0.280000001,		0.0],
[59,		0.289999992,	0.0],
[61,		0.300000012,		0.0],
[63,		0.310000002,	0.0],
[65,		0.319999993,		0.0],
[67,		0.330000013,		0.0],
[69,		0.340000004,		0.0],
[71,		0.349999994,		0.0],
[73,		0.360000014,		0.0],
[75,		0.370000005,		0.0],
[77,		0.379999995,		0.0],
[79,		0.389999986,		0.0],
[81,		0.400000006,		0.0]])

traction = np.array([
	[1, 0, -500],
	[3, 0, -500],
	[5, 0, -500],
	[7, 0, -500],
	[9, 0, -500],
	[11, 0, -500],
	[13, 0, -500],
	[15, 0, -500],
	[17, 0, -500],
	[19, 0, -500],
	[21, 0, -500],
	[23, 0, -500],
	[25, 0, -500],
	[27, 0, -500],
	[29, 0, -500],
	[31, 0, -500],
	[33, 0, -500],
	[35, 0, -500],
	[37, 0, -500],
	[39, 0, -500],
	[41, 0, -500],
	[43, 0, -500],
	[45, 0, -500],
	[47, 0, -500],
	[49, 0, -500],
	[51, 0, -500],
	[53, 0, -500],
	[55, 0, -500],
	[57, 0, -500],
	[59, 0, -500],
	[61, 0, -500],
	[63, 0, -500],
	[65, 0, -500],
	[67, 0, -500],
	[69, 0, -500],
	[71, 0, -500],
	[73, 0, -500],
	[75, 0, -500],
	[77, 0, -500],
	[79, 0, -500],
	[81, 0, -500]]) # A sequence of node must be in this list

rows, columns = np.shape(traction)

loading = np.zeros([rows, columns-1])

for i in range(rows-1):
	node1 = nodes[i, 1:]
	node2 = nodes[i+1, 1:]
	L = np.sqrt((node2[0] - node1[0])**2 + (node2[1] - node1[1])**2)
	T1 = L/2.0 * thickness * traction[i, 1:]
	T2 = L/2.0 * thickness * traction[i+1, 1:]
	loading[i, :] += T1
	loading[i+1, :] += T2

# Check input
outputpath = './traction.dat'
# Open output file to write
outputfile = open(outputpath, 'a+')
outputfile.write('<ExternalForces>\r')
for i in range(rows):
	strg1 = 'u[' + str(int(traction[i, 0])-1) + '] = ' + str(loading[i, 0]) + ';\r'
	outputfile.write(strg1)
	strg2 = 'v[' + str(int(traction[i, 0])-1) + '] = ' + str(loading[i, 1]) + ';\r'
	outputfile.write(strg2)
outputfile.write('</ExternalForces>\r')