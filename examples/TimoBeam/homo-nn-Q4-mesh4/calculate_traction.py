import numpy as np

thickness = 1

nodes = np.array([
	[7223,	    20.0	,	0.0],
	[7222,		20.0,		0.119047619],
	[7221,		20.0,		0.238095239],
	[7220,		20.0,		0.357142866],
	[7219,		20.0,		0.476190478],
	[7218,		20.0,		0.59523809],
	[7217,		20.0,		0.714285731],
	[7216,		20.0,		0.833333313],
	[7215,		20.0,		0.952380955],
	[7214,		20.0,		1.07142854],
	[7213,		20.0,		1.19047618],
	[7212,		20.0,		1.30952382],
	[7211,		20.0,		1.42857146],
	[7210,		20.0,		1.5476191],
	[7209,		20.0,		1.66666663],
	[7208,		20.0,		1.78571427],
	[7207,		20.0,		1.90476191],
	[7206,		20.0,		2.02380943],
	[7205,		20.0,		2.14285707],
	[7204,		20.0,		2.26190472],
	[7203,		20.0,		2.38095236],
	[7202,		20.0,		2.5],
	[7201,		20.0,		2.61904764],
	[7200,		20.0,		2.73809528],
	[7199,		20.0,		2.85714293],
	[7198,		20.0,		2.97619057],
	[7197,		20.0,		3.09523821],
	[7196,		20.0,		3.21428561],
	[7195,		20.0,		3.33333325],
	[7194,		20.0,		3.4523809],
	[7193,		20.0,		3.57142854],
	[7192,		20.0,		3.69047618],
	[7191,		20.0,		3.80952382],
	[7190,		20.0,		3.92857146],
	[7189,		20.0,		4.04761887],
	[7188,		20.0,		4.16666651],
	[7187,		20.0,		4.28571415],
	[7186,		20.0,		4.40476179],
	[7185,		20.0,		4.52380943],
	[7184,		20.0,		4.64285707],
	[7183,		20.0,		4.76190472],
	[7182,		20.0,		4.88095236],
	[7181,		20.0,		5.0]])

traction = np.array([
	[7223, 0.0, -0.25],
	[7222, 0.0, -0.25],
	[7221, 0.0, -0.25],
	[7220, 0.0, -0.25],
	[7219, 0.0, -0.25],
	[7218, 0.0, -0.25],
	[7217, 0.0, -0.25],
	[7216, 0.0, -0.25],
	[7215, 0.0, -0.25],
	[7214, 0.0, -0.25],
	[7213, 0.0, -0.25],
	[7212, 0.0, -0.25],
	[7211, 0.0, -0.25],
	[7210, 0.0, -0.25],
	[7209, 0.0, -0.25],
	[7208, 0.0, -0.25],
	[7207, 0.0, -0.25],
	[7206, 0.0, -0.25],
	[7205, 0.0, -0.25],
	[7204, 0.0, -0.25],
	[7203, 0.0, -0.25],
	[7202, 0.0, -0.25],
	[7201, 0.0, -0.25],
	[7200, 0.0, -0.25],
	[7199, 0.0, -0.25],
	[7198, 0.0, -0.25],
	[7197, 0.0, -0.25],
	[7196, 0.0, -0.25],
	[7195, 0.0, -0.25],
	[7194, 0.0, -0.25],
	[7193, 0.0, -0.25],
	[7192, 0.0, -0.25],
	[7191, 0.0, -0.25],
	[7190, 0.0, -0.25],
	[7189, 0.0, -0.25],
	[7188, 0.0, -0.25],
	[7187, 0.0, -0.25],
	[7186, 0.0, -0.25],
	[7185, 0.0, -0.25],
	[7184, 0.0, -0.25],
	[7183, 0.0, -0.25],
	[7182, 0.0, -0.25],
	[7181, 0.0, -0.25]])  # A sequence of node must be in this list

rows, columns = np.shape(traction)

loading = np.zeros([rows, columns-1])

for i in range(rows-1):
	node1 = nodes[i, 1:]
	node2 = nodes[i+1, 1:]
	L = np.sqrt((node2[0] - node1[0])**2 + (node2[1] - node1[1])**2)
	T1 = L/2.0 * thickness * traction[i, 1:]
	T2 = L/2.0 * thickness * traction[i+1, 1:]
	loading[i, :] += T1
	loading[i+1, :] += T2

# Check input
outputpath = './traction.dat'
# Open output file to write
outputfile = open(outputpath, 'a+')
outputfile.write('<ExternalForces>\r')
for i in range(rows):
	strg1 = 'u[' + str(int(traction[i, 0])) + '] = ' + str(loading[i, 0]) + ';\r'
	outputfile.write(strg1)
	strg2 = 'v[' + str(int(traction[i, 0])) + '] = ' + str(loading[i, 1]) + ';\r'
	outputfile.write(strg2)
outputfile.write('</ExternalForces>\r')