import numpy as np

thickness = 1

nodes = np.array([
	[2625,		20.0,		0.0],
	[2624,		20.0,		0.200000003],
	[2623,		20.0,		0.400000006],
	[2622,		20.0,		0.600000024],
	[2621,		20.0,		0.800000012],
	[2620,		20.0,		1.0],
	[2619,		20.0,		1.20000005],
	[2618,		20.0,		1.39999998],
	[2617,		20.0,		1.60000002],
	[2616,		20.0,		1.79999995],
	[2615,		20.0,		2.0],
	[2614,		20.0,		2.20000005],
	[2613,		20.0,		2.4000001],
	[2612,		20.0,		2.5999999],
	[2611,		20.0,		2.79999995],
	[2610,		20.0,		3.0],
	[2609,		20.0,		3.20000005],
	[2608,		20.0,		3.4000001],
	[2607,		20.0,		3.5999999],
	[2606,		20.0,		3.79999995],
	[2605,		20.0,		4.0],
	[2604,		20.0,		4.19999981],
	[2603,		20.0,		4.4000001],
	[2602,		20.0,		4.5999999],
	[2601,		20.0,		4.80000019],
	[2600,		20.0,		5.0]])

traction = np.array([
	[2625, 0.0, -0.25],
	[2624, 0.0, -0.25],
	[2623, 0.0, -0.25],
	[2622, 0.0, -0.25],
	[2621, 0.0, -0.25],
	[2620, 0.0, -0.25],
	[2619, 0.0, -0.25],
	[2618, 0.0, -0.25],
	[2617, 0.0, -0.25],
	[2616, 0.0, -0.25],
	[2615, 0.0, -0.25],
	[2614, 0.0, -0.25],
	[2613, 0.0, -0.25],
	[2612, 0.0, -0.25],
	[2611, 0.0, -0.25],
	[2610, 0.0, -0.25],
	[2609, 0.0, -0.25],
	[2608, 0.0, -0.25],
	[2607, 0.0, -0.25],
	[2606, 0.0, -0.25],
	[2605, 0.0, -0.25],
	[2604, 0.0, -0.25],
	[2603, 0.0, -0.25],
	[2602, 0.0, -0.25],
	[2601, 0.0, -0.25],
	[2600, 0.0, -0.25]])  # A sequence of node must be in this list

rows, columns = np.shape(traction)

loading = np.zeros([rows, columns-1])

for i in range(rows-1):
	node1 = nodes[i, 1:]
	node2 = nodes[i+1, 1:]
	L = np.sqrt((node2[0] - node1[0])**2 + (node2[1] - node1[1])**2)
	T1 = L/2.0 * thickness * traction[i, 1:]
	T2 = L/2.0 * thickness * traction[i+1, 1:]
	loading[i, :] += T1
	loading[i+1, :] += T2

# Check input
outputpath = './traction.dat'
# Open output file to write
outputfile = open(outputpath, 'a+')
outputfile.write('<ExternalForces>\r')
for i in range(rows):
	strg1 = 'u[' + str(int(traction[i, 0])) + '] = ' + str(loading[i, 0]) + ';\r'
	outputfile.write(strg1)
	strg2 = 'v[' + str(int(traction[i, 0])) + '] = ' + str(loading[i, 1]) + ';\r'
	outputfile.write(strg2)
outputfile.write('</ExternalForces>\r')